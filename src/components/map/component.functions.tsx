import leaflet from 'leaflet'

export const createClusterIcon = <T extends object>(
  cluster: leaflet.MarkerCluster,
  getCustomClusterLabel?: (markers: T[]) => string
) => {
  const markersCount = cluster.getChildCount()
  const markers = cluster.getAllChildMarkers()
  const customLabel = getCustomClusterLabel?.(markers.map(m => (m.options as { options: T }).options))

  return new leaflet.DivIcon({
    html: `
      <div style="position: relative; width: 100%; height: 100%; display: flex; justify-content: center;">
        <svg width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="#2A77EE" d="M34.125 18.375C34.125 30.8735 21 38.0625 21 38.0625C21 38.0625 7.875 30.8735 7.875 18.375C7.875 14.894 9.25781 11.5556 11.7192 9.09422C14.1806 6.63281 17.519 5.25 21 5.25C24.481 5.25 27.8194 6.63281 30.2808 9.09422C32.7422 11.5556 34.125 14.894 34.125 18.375ZM21.0003 6.33599C17.8074 6.33599 14.7453 7.60436 12.4876 9.86207C10.2298 12.1198 8.96148 15.1819 8.96148 18.3748C8.96148 24.2256 12.0337 28.8895 15.2148 32.1465C16.7986 33.768 18.3854 35.0153 19.5762 35.8565C20.1675 36.2743 20.6588 36.5902 21.0003 36.8006C21.3417 36.5902 21.833 36.2743 22.4243 35.8565C23.6152 35.0153 25.202 33.768 26.7857 32.1465C29.9668 28.8895 33.0391 24.2256 33.0391 18.3748C33.0391 15.1819 31.7707 12.1198 29.513 9.86207C27.2553 7.60436 24.1932 6.33599 21.0003 6.33599ZM21.0003 38.0623C20.4785 39.0149 20.4781 39.0147 20.4776 39.0145L20.4765 39.0139L20.4733 39.0121L20.4634 39.0066L20.4297 38.9877C20.401 38.9716 20.3603 38.9485 20.3083 38.9183C20.2042 38.858 20.0549 38.7697 19.8668 38.6539C19.4907 38.4223 18.9587 38.0801 18.3228 37.6309C17.0527 36.7336 15.3582 35.4025 13.6607 33.6644C10.2793 30.2024 6.78906 25.0224 6.78906 18.3748C6.78906 14.6057 8.28631 10.9911 10.9514 8.32594C13.6165 5.66082 17.2312 4.16357 21.0003 4.16357C24.7693 4.16357 28.384 5.66082 31.0491 8.32594C33.7142 10.9911 35.2115 14.6057 35.2115 18.3748C35.2115 25.0224 31.7212 30.2024 28.3398 33.6644C26.6423 35.4025 24.9479 36.7336 23.6778 37.6309C23.0418 38.0801 22.5099 38.4223 22.1338 38.6539C21.9456 38.7697 21.7963 38.858 21.6923 38.9183C21.6402 38.9485 21.5995 38.9716 21.5709 38.9877L21.5371 39.0066L21.5272 39.0121L21.524 39.0139L21.5229 39.0145C21.5225 39.0147 21.5221 39.0149 21.0003 38.0623ZM21.0003 38.0623L21.5221 39.0149C21.197 39.193 20.8035 39.193 20.4785 39.0149L21.0003 38.0623Z"/>
          <path fill="#F7FAFF" d="M26.25 18.375C26.25 19.7674 25.6969 21.1027 24.7123 22.0873C23.7277 23.0719 22.3924 23.625 21 23.625C19.6076 23.625 18.2723 23.0719 17.2877 22.0873C16.3031 21.1027 15.75 19.7674 15.75 18.375C15.75 16.9826 16.3031 15.6473 17.2877 14.6627C18.2723 13.6781 19.6076 13.125 21 13.125C22.3924 13.125 23.7277 13.6781 24.7123 14.6627C25.6969 15.6473 26.25 16.9826 26.25 18.375Z"/>
          <path fill="#2A77EE" d="M21.0003 14.211C19.896 14.211 18.8369 14.6497 18.056 15.4305C17.2752 16.2114 16.8365 17.2705 16.8365 18.3748C16.8365 19.4791 17.2752 20.5382 18.056 21.319C18.8369 22.0999 19.896 22.5386 21.0003 22.5386C22.1046 22.5386 23.1637 22.0999 23.9445 21.319C24.7254 20.5382 25.1641 19.4791 25.1641 18.3748C25.1641 17.2705 24.7254 16.2114 23.9445 15.4305C23.1637 14.6497 22.1046 14.211 21.0003 14.211ZM16.5199 13.8944C17.7082 12.7061 19.3198 12.0386 21.0003 12.0386C22.6807 12.0386 24.2924 12.7061 25.4806 13.8944C26.6689 15.0827 27.3365 16.6943 27.3365 18.3748C27.3365 20.0552 26.6689 21.6669 25.4806 22.8552C24.2924 24.0434 22.6807 24.711 21.0003 24.711C19.3198 24.711 17.7082 24.0434 16.5199 22.8552C15.3316 21.6669 14.6641 20.0552 14.6641 18.3748C14.6641 16.6943 15.3316 15.0827 16.5199 13.8944Z"/>
        </svg>
        <div 
          style="
            position: absolute;
            top: -30px;
            background-color: #2A77EE;
            padding: 0px 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 500;
            font-size: 20px;
            line-height: 150%;
            letter-spacing: -0.03em;
            color: #F7FAFF;
            white-space: nowrap;
          "
        >
          ${markersCount} | ${customLabel}
        </div>
      </div>
    `,
    iconSize: new leaflet.Point(42, 42),
    iconAnchor: [21, 42]
  })
}

export const customTextIcon = (text: string) =>
  new leaflet.DivIcon({
    html: `
      <div style="position: relative; width: 100%; height: 100%; display: flex; justify-content: center;">
        <svg width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill="#2A77EE" d="M34.125 18.375C34.125 30.8735 21 38.0625 21 38.0625C21 38.0625 7.875 30.8735 7.875 18.375C7.875 14.894 9.25781 11.5556 11.7192 9.09422C14.1806 6.63281 17.519 5.25 21 5.25C24.481 5.25 27.8194 6.63281 30.2808 9.09422C32.7422 11.5556 34.125 14.894 34.125 18.375ZM21.0003 6.33599C17.8074 6.33599 14.7453 7.60436 12.4876 9.86207C10.2298 12.1198 8.96148 15.1819 8.96148 18.3748C8.96148 24.2256 12.0337 28.8895 15.2148 32.1465C16.7986 33.768 18.3854 35.0153 19.5762 35.8565C20.1675 36.2743 20.6588 36.5902 21.0003 36.8006C21.3417 36.5902 21.833 36.2743 22.4243 35.8565C23.6152 35.0153 25.202 33.768 26.7857 32.1465C29.9668 28.8895 33.0391 24.2256 33.0391 18.3748C33.0391 15.1819 31.7707 12.1198 29.513 9.86207C27.2553 7.60436 24.1932 6.33599 21.0003 6.33599ZM21.0003 38.0623C20.4785 39.0149 20.4781 39.0147 20.4776 39.0145L20.4765 39.0139L20.4733 39.0121L20.4634 39.0066L20.4297 38.9877C20.401 38.9716 20.3603 38.9485 20.3083 38.9183C20.2042 38.858 20.0549 38.7697 19.8668 38.6539C19.4907 38.4223 18.9587 38.0801 18.3228 37.6309C17.0527 36.7336 15.3582 35.4025 13.6607 33.6644C10.2793 30.2024 6.78906 25.0224 6.78906 18.3748C6.78906 14.6057 8.28631 10.9911 10.9514 8.32594C13.6165 5.66082 17.2312 4.16357 21.0003 4.16357C24.7693 4.16357 28.384 5.66082 31.0491 8.32594C33.7142 10.9911 35.2115 14.6057 35.2115 18.3748C35.2115 25.0224 31.7212 30.2024 28.3398 33.6644C26.6423 35.4025 24.9479 36.7336 23.6778 37.6309C23.0418 38.0801 22.5099 38.4223 22.1338 38.6539C21.9456 38.7697 21.7963 38.858 21.6923 38.9183C21.6402 38.9485 21.5995 38.9716 21.5709 38.9877L21.5371 39.0066L21.5272 39.0121L21.524 39.0139L21.5229 39.0145C21.5225 39.0147 21.5221 39.0149 21.0003 38.0623ZM21.0003 38.0623L21.5221 39.0149C21.197 39.193 20.8035 39.193 20.4785 39.0149L21.0003 38.0623Z"/>
          <path fill="#F7FAFF" d="M26.25 18.375C26.25 19.7674 25.6969 21.1027 24.7123 22.0873C23.7277 23.0719 22.3924 23.625 21 23.625C19.6076 23.625 18.2723 23.0719 17.2877 22.0873C16.3031 21.1027 15.75 19.7674 15.75 18.375C15.75 16.9826 16.3031 15.6473 17.2877 14.6627C18.2723 13.6781 19.6076 13.125 21 13.125C22.3924 13.125 23.7277 13.6781 24.7123 14.6627C25.6969 15.6473 26.25 16.9826 26.25 18.375Z"/>
          <path fill="#2A77EE" d="M21.0003 14.211C19.896 14.211 18.8369 14.6497 18.056 15.4305C17.2752 16.2114 16.8365 17.2705 16.8365 18.3748C16.8365 19.4791 17.2752 20.5382 18.056 21.319C18.8369 22.0999 19.896 22.5386 21.0003 22.5386C22.1046 22.5386 23.1637 22.0999 23.9445 21.319C24.7254 20.5382 25.1641 19.4791 25.1641 18.3748C25.1641 17.2705 24.7254 16.2114 23.9445 15.4305C23.1637 14.6497 22.1046 14.211 21.0003 14.211ZM16.5199 13.8944C17.7082 12.7061 19.3198 12.0386 21.0003 12.0386C22.6807 12.0386 24.2924 12.7061 25.4806 13.8944C26.6689 15.0827 27.3365 16.6943 27.3365 18.3748C27.3365 20.0552 26.6689 21.6669 25.4806 22.8552C24.2924 24.0434 22.6807 24.711 21.0003 24.711C19.3198 24.711 17.7082 24.0434 16.5199 22.8552C15.3316 21.6669 14.6641 20.0552 14.6641 18.3748C14.6641 16.6943 15.3316 15.0827 16.5199 13.8944Z"/>
        </svg>
        <div 
          style="
            position: absolute;
            top: -30px;
            background-color: #2A77EE;
            padding: 0px 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 500;
            font-size: 20px;
            line-height: 150%;
            letter-spacing: -0.03em;
            color: #F7FAFF;
            white-space: nowrap;
          "
        >
          ${text}
        </div>
      </div>
    `,
    iconSize: new leaflet.Point(42, 42),
    iconAnchor: [21, 42],
    popupAnchor: [0, -36]
  })

export const customDefaultIcon = () =>
  new leaflet.DivIcon({
    html: `
        <div style="position: relative; width: 100%; height: 100%; display: flex; justify-content: center;">
          <svg width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill="#2A77EE" d="M34.125 18.375C34.125 30.8735 21 38.0625 21 38.0625C21 38.0625 7.875 30.8735 7.875 18.375C7.875 14.894 9.25781 11.5556 11.7192 9.09422C14.1806 6.63281 17.519 5.25 21 5.25C24.481 5.25 27.8194 6.63281 30.2808 9.09422C32.7422 11.5556 34.125 14.894 34.125 18.375ZM21.0003 6.33599C17.8074 6.33599 14.7453 7.60436 12.4876 9.86207C10.2298 12.1198 8.96148 15.1819 8.96148 18.3748C8.96148 24.2256 12.0337 28.8895 15.2148 32.1465C16.7986 33.768 18.3854 35.0153 19.5762 35.8565C20.1675 36.2743 20.6588 36.5902 21.0003 36.8006C21.3417 36.5902 21.833 36.2743 22.4243 35.8565C23.6152 35.0153 25.202 33.768 26.7857 32.1465C29.9668 28.8895 33.0391 24.2256 33.0391 18.3748C33.0391 15.1819 31.7707 12.1198 29.513 9.86207C27.2553 7.60436 24.1932 6.33599 21.0003 6.33599ZM21.0003 38.0623C20.4785 39.0149 20.4781 39.0147 20.4776 39.0145L20.4765 39.0139L20.4733 39.0121L20.4634 39.0066L20.4297 38.9877C20.401 38.9716 20.3603 38.9485 20.3083 38.9183C20.2042 38.858 20.0549 38.7697 19.8668 38.6539C19.4907 38.4223 18.9587 38.0801 18.3228 37.6309C17.0527 36.7336 15.3582 35.4025 13.6607 33.6644C10.2793 30.2024 6.78906 25.0224 6.78906 18.3748C6.78906 14.6057 8.28631 10.9911 10.9514 8.32594C13.6165 5.66082 17.2312 4.16357 21.0003 4.16357C24.7693 4.16357 28.384 5.66082 31.0491 8.32594C33.7142 10.9911 35.2115 14.6057 35.2115 18.3748C35.2115 25.0224 31.7212 30.2024 28.3398 33.6644C26.6423 35.4025 24.9479 36.7336 23.6778 37.6309C23.0418 38.0801 22.5099 38.4223 22.1338 38.6539C21.9456 38.7697 21.7963 38.858 21.6923 38.9183C21.6402 38.9485 21.5995 38.9716 21.5709 38.9877L21.5371 39.0066L21.5272 39.0121L21.524 39.0139L21.5229 39.0145C21.5225 39.0147 21.5221 39.0149 21.0003 38.0623ZM21.0003 38.0623L21.5221 39.0149C21.197 39.193 20.8035 39.193 20.4785 39.0149L21.0003 38.0623Z"/>
            <path fill="#F7FAFF" d="M26.25 18.375C26.25 19.7674 25.6969 21.1027 24.7123 22.0873C23.7277 23.0719 22.3924 23.625 21 23.625C19.6076 23.625 18.2723 23.0719 17.2877 22.0873C16.3031 21.1027 15.75 19.7674 15.75 18.375C15.75 16.9826 16.3031 15.6473 17.2877 14.6627C18.2723 13.6781 19.6076 13.125 21 13.125C22.3924 13.125 23.7277 13.6781 24.7123 14.6627C25.6969 15.6473 26.25 16.9826 26.25 18.375Z"/>
            <path fill="#2A77EE" d="M21.0003 14.211C19.896 14.211 18.8369 14.6497 18.056 15.4305C17.2752 16.2114 16.8365 17.2705 16.8365 18.3748C16.8365 19.4791 17.2752 20.5382 18.056 21.319C18.8369 22.0999 19.896 22.5386 21.0003 22.5386C22.1046 22.5386 23.1637 22.0999 23.9445 21.319C24.7254 20.5382 25.1641 19.4791 25.1641 18.3748C25.1641 17.2705 24.7254 16.2114 23.9445 15.4305C23.1637 14.6497 22.1046 14.211 21.0003 14.211ZM16.5199 13.8944C17.7082 12.7061 19.3198 12.0386 21.0003 12.0386C22.6807 12.0386 24.2924 12.7061 25.4806 13.8944C26.6689 15.0827 27.3365 16.6943 27.3365 18.3748C27.3365 20.0552 26.6689 21.6669 25.4806 22.8552C24.2924 24.0434 22.6807 24.711 21.0003 24.711C19.3198 24.711 17.7082 24.0434 16.5199 22.8552C15.3316 21.6669 14.6641 20.0552 14.6641 18.3748C14.6641 16.6943 15.3316 15.0827 16.5199 13.8944Z"/>
          </svg>
        </div>
      `,
    iconSize: new leaflet.Point(42, 42),
    iconAnchor: [21, 42],
    popupAnchor: [0, -36]
  })
